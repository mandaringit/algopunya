<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <div id="map" style="width:100%;height:400px;"></div>

    <button id="center">모여라</button>
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=APPKEY">
    </script>
    <script src="./circumcenter.js"></script>
    <script>
        alert('앱키등록하고쓰세요')

        function createMarker(position) {
            const newMarker = new kakao.maps.Marker({
                map,
                position
            })
            markers.push(newMarker)
            newMarker.setMap(map)

            if (markers.length > 3) {
                // 3개 이상일 때 지우고 넣기
                marker = markers.shift()
                marker.setMap(null)
            }
        }

        function createCenterMarker() {
            if (markers.length === 3) {
                // 외심 구하기
                allLatLng = markers.map(marker => {
                    const {
                        Ga,
                        Ha
                    } = marker.getPosition()
                    return [Ha, Ga]
                })
                center = circumcenter(allLatLng)
                const position = new kakao.maps.LatLng(...center)

                if (centerMarker) {
                    centerMarker.setMap(null)
                }

                centerMarker = new kakao.maps.Marker({
                    map,
                    position
                })
            } else {
                console.log('마커를 더 찍어주세요')
            }
        }

        const container = document.querySelector('#map') //지도를 담을 영역의 DOM 레퍼런스
        const options = { //지도를 생성할 때 필요한 기본 옵션
            center: new kakao.maps.LatLng(35.205382, 126.811603), //지도의 중심좌표.
            level: 3,
        }

        const map = new kakao.maps.Map(container, options) //지도 생성 및 객체 리턴
        const markers = []
        let centerMarker;

        kakao.maps.event.addListener(map, 'click', e => createMarker(e.latLng))
        // 버튼 클릭시 세 점의 위도 경도를 콘솔에 출력
        const gatheringBtn = document.querySelector("#center")
        gatheringBtn.addEventListener('click', createCenterMarker)
    </script>
</body>

</html>